<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <link rel="icon" href="data:,">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <title>你是一個一個登入界面啊啊啊啊</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #ff99cc, #cc99ff);
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Comic Sans MS', cursive;
            position: relative;
            overflow: hidden;
        }

        @keyframes rainbow {
            0% {
                background-color: red;
            }

            15% {
                background-color: orange;
            }

            30% {
                background-color: yellow;
            }

            45% {
                background-color: green;
            }

            60% {
                background-color: blue;
            }

            75% {
                background-color: indigo;
            }

            90% {
                background-color: violet;
            }

            100% {
                background-color: red;
            }
        }

        .rainbow-background {
            animation: rainbow 0.5s linear infinite;
        }

        .error-flash {
            pointer-events: none;
            border: 2px solid red;
            animation: flash 0.5s linear alternate infinite;
        }

        @keyframes flash {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        .neuro-float {
            position: absolute;
            opacity: 0.3;
            animation: float 3s infinite;
        }

        .dssq-box {
            position: fixed;
            bottom: -50px;
            right: -50px;
            width: 200px;
            height: 200px;
            background: url("{{ url_for('static', filename='image/yaju-senpai.png') }}") no-repeat;
            opacity: 0.1;
            transform: rotate(24deg);
            display: none;
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            position: relative;
            overflow: hidden;
        }

        .card-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ff3366;
            text-shadow: 2px 2px 0 #fff;
            font-family: 'Press Start 2P', cursive;
        }

        @keyframes glitch {
            0% {
                transform: translate(0);
            }

            20% {
                transform: translate(-2px, 2px);
            }

            40% {
                transform: translate(-2px, -2px);
            }

            60% {
                transform: translate(2px, 2px);
            }

            80% {
                transform: translate(2px, -2px);
            }

            100% {
                transform: translate(0);
            }
        }

        .form-select {
            border-radius: 25px;
            background: #fff;
            transition: all 0.3s;
        }

        .form-select:focus {
            border-color: #ff99cc;
            box-shadow: 0 0 0 0.25rem rgba(255, 153, 204, 0.25);
            animation: glitch 0.3s infinite;
        }

        .btn {
            border-radius: 25px;
            padding: 10px 30px;
            font-size: 1.1rem;
            background: #ff3366;
            border: none;
            position: relative;
            overflow: hidden;
            transition: 0.3s;
        }

        .btn:hover {
            background: #cc0066;
            transform: scale(1.05);
        }

        .btn:active::after {
            content: "（＞人＜；）";
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            color: #ff3366;
            font-size: 1.2rem;
        }

        #username option:nth-child(2)::after {
            content: "(114514)";
            color: #999;
            margin-left: 10px;
            font-size: 0.8em;
        }

        @keyframes float {
            0% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(5deg);
            }

            100% {
                transform: translateY(0px) rotate(0deg);
            }
        }

        .pixel-border {
            position: absolute;
            background: repeating-linear-gradient(45deg,
                    #ff3366, #ff3366 5px, #fff 5px, #fff 10px);
            animation: borderScroll 2s linear infinite;
        }

        @keyframes borderScroll {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: 10px 10px;
            }
        }

        .yasen-box {
            position: fixed;
            width: 80px;
            height: 80px;
            opacity: 0;
            transition: all 0.5s;
            pointer-events: none;
            background: url("{{ url_for('static', filename='image/yaju-senpai.png') }}") no-repeat center/contain;
            z-index: 9999;
        }

        @keyframes yasen-pop {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }

            20% {
                transform: scale(1.2) rotate(24deg);
                opacity: 0.3;
            }

            100% {
                transform: scale(1) rotate(114deg);
                opacity: 0;
            }
        }

        .float-element {
            position: absolute;
            opacity: 0.3;
            animation: float 3s infinite;
            pointer-events: none;
        }

        .neuro-float-img {
            width: 200px;
            height: 200px;
            background: url("{{ url_for('static', filename='image/neuro.png') }}") no-repeat center/contain;
        }

        .glitch-mode {
            animation: glitch 0.3s infinite, hueShift 2s infinite;
        }

        @keyframes hueShift {
            0% {
                filter: hue-rotate(0deg);
            }

            100% {
                filter: hue-rotate(360deg);
            }
        }

        .egg-active {
            animation: yasen-pop 1.5s, glitch 0.3s infinite;
        }

        .heart-throb {
            animation: heartbeat 1s infinite;
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        @keyframes bounce {
            0% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-20px);
            }

            100% {
                transform: translateY(0);
            }
        }

        @keyframes vibrate {
            0% {
                transform: translate(0, 0);
            }

            20% {
                transform: translate(-2px, 2px);
            }

            40% {
                transform: translate(2px, -2px);
            }

            60% {
                transform: translate(-2px, 2px);
            }

            80% {
                transform: translate(2px, -2px);
            }

            100% {
                transform: translate(0, 0);
            }
        }

        .neuro-pinball {
            position: fixed;
            width: 100px;
            height: 100px;
            background: url("{{ url_for('static', filename='image/neuro.png') }}") no-repeat center/contain;
            pointer-events: none;
            z-index: 9998;
        }

        .homo-vibrate {
            position: fixed;
            width: 80px;
            height: 80px;
            background: url("{{ url_for('static', filename='image/yaju-senpai.png') }}") no-repeat center/contain;
            animation: vibrate 0.5s linear infinite;
            pointer-events: none;
            z-index: 9999;
        }
    </style>
</head>

<body>
    <div class="neuro-float" style="top:10%;left:10%">(´•ω•`)</div>
    <div class="neuro-float" style="top:30%;right:15%">＞▽＜</div>

    <div class="dssq-box"></div>
    <div class="yasen-box"></div>

    <div class="card p-4">
        <div class="pixel-border" style="width:100%;height:5px;top:0"></div>
        <div class="card-body">
            <h2 class="card-title text-center mb-4 heart-throb">
                ♡ 選 擇 帳 號 ♡<br>
                <small style="font-size:0.4em">(絕對不是 gaslighting)</small>
            </h2>
            <p class="text-center mb-4" style="color: #ff3366">
                ⚠️ 注意：只能選兩個人！<tiny> 還是你想多一人？(小聲 </tiny>
            </p>
            <form action="/chat" method="get">
                <div class="mb-3">
                    <label for="username" class="form-label" style="color: #ff3366">
                        用戶名稱（一個一個一個...）
                    </label>
                    <select name="username" id="username" class="form-select">
                        <option value="Alice">Alice（尊い...）</option>
                        <option value="Bob">Bob（哼哼啊啊啊啊）</option>
                    </select>
                </div>
                <div class="d-grid">
                    <button type="submit" class="btn btn-primary">
                        <span style="vertical-align: middle">立刻登入！</span>
                        <span style="font-size:0.8em">(っ◕‿◕)っ</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- 隱藏音效元素 -->
    <audio id="homoSound" src="{{ url_for('static', filename='music/beast_noice.mp3') }}"></audio>

    <script>
        // 取得必要元素
        const yasenBox = document.querySelector('.yasen-box');
        const homoSound = document.getElementById('homoSound');
        const usernameSelect = document.getElementById('username');

        // 點擊事件：僅觸發先輩彩蛋（移除原來 EGG 參照）
        let clickTriggerCount = 0;
        let lastClickTime = 0;
        document.addEventListener('click', (e) => {
            const now = Date.now();
            if (now - lastClickTime < 300) {
                clickTriggerCount++;
                if (clickTriggerCount >= 2) {
                    spawnYasen(e.clientX, e.clientY);
                    clickTriggerCount = 0;
                }
            } else {
                clickTriggerCount = 0;
            }
            lastClickTime = now;
            // 隨機旋轉效果
            if (Math.random() < 0.1) {
                e.target.style.transform = `rotate(${Math.random() * 10 - 5}deg)`;
            }
        });

        // 隨機自動觸發先輩彩蛋
        if (Math.random() < 0.3) {
            setTimeout(() => {
                spawnYasen(Math.random() * window.innerWidth, Math.random() * window.innerHeight);
            }, 10000 + Math.random() * 15000);
        }

        // 下拉選單彩蛋：選擇 'Bob' 時播放音效並改變整個螢幕背景為 #ffd700
        usernameSelect.addEventListener('change', function () {
            if (this.value === 'Bob') {
                homoSound.play();
                document.body.style.backgroundColor = '#ffd700';
                setTimeout(() => {
                    document.body.style.backgroundColor = '';
                }, 5000);
            }
        });

        // 鍵盤彩蛋：依據輸入觸發 neuro 與 homo
        let comboNeuro = "";
        let comboHomo = "";
        document.addEventListener('keyup', (e) => {
            const key = e.key.toLowerCase();
            comboNeuro += key;
            comboHomo += key;
            if (comboNeuro.length > 5) comboNeuro = comboNeuro.slice(-5);
            if (comboHomo.length > 4) comboHomo = comboHomo.slice(-4);
            if (comboNeuro === "neuro") {
                triggerNeuro();
                comboNeuro = "";
            }
            if (comboHomo === "homo") {
                triggerHomo();
                comboHomo = "";
            }
        });

        // 先輩彩蛋（點擊觸發）
        function spawnYasen(x, y) {
            yasenBox.style.left = `${x - 40}px`;
            yasenBox.style.top = `${y - 40}px`;
            yasenBox.style.animation = 'yasen-pop 1.5s';
            yasenBox.style.opacity = '1';
            setTimeout(() => {
                yasenBox.style.animation = '';
                yasenBox.style.opacity = '0';
            }, 1500);
        }

        function triggerNeuro() {
            const card = document.querySelector('.card');
            if (card) {
                card.classList.add('error-flash');
                setTimeout(() => {
                    card.classList.remove('error-flash');
                }, 2000);
            }
            document.body.classList.add('rainbow-background');

            const count = Math.floor(Math.random() * 16) + 5; // 隨機 5 至 20 張
            let neuroEggs = [];
            for (let i = 0; i < count; i++) {
                const neuroElem = document.createElement('div');
                neuroElem.classList.add('neuro-pinball');
                // 隨機初始位置
                const x = Math.random() * (window.innerWidth - 100);
                const y = Math.random() * (window.innerHeight - 100);
                neuroElem.style.left = x + 'px';
                neuroElem.style.top = y + 'px';
                // 隨機移動速度與方向
                const angle = Math.random() * 2 * Math.PI;
                const speed = 0.3 + Math.random() * 0.2;
                const dx = Math.cos(angle) * speed;
                const dy = Math.sin(angle) * speed;
                neuroElem.dataset.dx = dx;
                neuroElem.dataset.dy = dy;
                document.body.appendChild(neuroElem);
                neuroEggs.push(neuroElem);
            }
            let startTime = performance.now();
            let lastTime = startTime;
            function animate(time) {
                const deltaTime = time - lastTime;
                lastTime = time;
                neuroEggs.forEach(function (elem) {
                    let posX = parseFloat(elem.style.left);
                    let posY = parseFloat(elem.style.top);
                    let dx = parseFloat(elem.dataset.dx);
                    let dy = parseFloat(elem.dataset.dy);
                    posX += dx * deltaTime;
                    posY += dy * deltaTime;
                    if (posX <= 0 || posX >= window.innerWidth - 100) {
                        dx = -dx;
                        posX = Math.max(0, Math.min(posX, window.innerWidth - 100));
                    }
                    if (posY <= 0 || posY >= window.innerHeight - 100) {
                        dy = -dy;
                        posY = Math.max(0, Math.min(posY, window.innerHeight - 100));
                    }
                    elem.style.left = posX + 'px';
                    elem.style.top = posY + 'px';
                    elem.dataset.dx = dx;
                    elem.dataset.dy = dy;
                });
                if (time - startTime < 5000) { // 持續 5 秒
                    requestAnimationFrame(animate);
                } else {
                    neuroEggs.forEach(elem => elem.remove());
                    document.body.classList.remove('rainbow-background');
                }
            }
            requestAnimationFrame(animate);
        }

        // homo 彩蛋：隨機 5 至 20 張圖片，且背景變成 #ffd700
        function triggerHomo() {
            document.body.style.backgroundColor = '#ffd700';
            const count = Math.floor(Math.random() * 16) + 5;
            homoSound.play();
            for (let i = 0; i < count; i++) {
                const homoElem = document.createElement('div');
                homoElem.classList.add('homo-vibrate');
                homoElem.style.left = Math.random() * (window.innerWidth - 80) + "px";
                homoElem.style.top = Math.random() * (window.innerHeight - 80) + "px";
                document.body.appendChild(homoElem);
                setTimeout(() => {
                    homoElem.remove();
                }, 5000);
            }
            setTimeout(() => {
                document.body.style.backgroundColor = '';
            }, 5000);
        }

        // 外部呼叫的 Homo Mode 啟用函式（保留原有點擊模式）
        window.enableHomoMode = () => {
            setInterval(() => {
                spawnYasen(Math.random() * window.innerWidth, Math.random() * window.innerHeight);
            }, 5000);
        };
    </script>
</body>

</html>